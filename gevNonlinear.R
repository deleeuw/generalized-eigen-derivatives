dsA <- function(theta, ...) {
  # This routine returns a matrix D_sA
}

dsB <- function(theta, ...) {
  # This routine returns a matrix D_sB
}

dstA <- function(theta, ...) {
  # This routine returns a n x n symmetric matrix with elements D_{st}a_{ij}
}

dstB <- function(theta, ...) {
  # This routine returns an array D_{st}B
}

theA <- function(theta, ...) {
  # This routine return the matrix A
}

theB <- function(theta, ...) {
  # This routine return the matrix B
}